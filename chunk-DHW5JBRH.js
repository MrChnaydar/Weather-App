import{a as f}from"./chunk-4TW45YYX.js";import{h as y}from"./chunk-WHD2HB6H.js";import{U as a,_ as s,d as g,k as b,v as p}from"./chunk-FDNLW5EG.js";var c=class i{APIKEY="14165bbcf9dd417ddc8ee87ecd6fbe32";getKey(){return this.APIKEY}static \u0275fac=function(e){return new(e||i)};static \u0275prov=a({token:i,factory:i.\u0275fac,providedIn:"root"})};var h=class i{http=s(y);getWeatherDataFromApi(t,e,r,o){let n=`https://api.openweathermap.org/data/2.5/weather?q=${e},${r}&appid=${t}&units=${o}`;return this.http.get(n)}getReverseLocationInfo(t,e,r,o){return g(this,null,function*(){let n=`https://api.openweathermap.org/geo/1.0/reverse?lat=${e}&lon=${r}&limit=1&appid=${t}`,u="",l="",m=yield p(this.http.get(n));return u=m[0]?.name,l=m[0]?.country,p(this.getWeatherDataFromApi(t,u,l,o))})}getLocationInfo(t,e){let r=`https://api.openweathermap.org/geo/1.0/direct?q=${e}&limit=5&appid=${t}`;return this.http.get(r)}getTwoWeeksForcast(t,e,r,o){let n=`https://api.openweathermap.org/data/3.0/onecall?lat=${e}&lon=${r}&exclude=minutely,hourly,alerts&appid=${t}&units=${o}`;return this.http.get(n)}static \u0275fac=function(e){return new(e||i)};static \u0275prov=a({token:i,factory:i.\u0275fac,providedIn:"root"})};var d=class i{unit=s(f);haveData=!1;apikeyservice=s(c);weatherdata=s(h);data;currentWeatherSubject=new b(null);twoWeeksData;listCities=[];searchLocation;visibilityKM;setCurrentWeatherData(t){this.visibilityKM=Math.round(t.visibility/1e3),this.unit.getSettings().distanceUnits=="mi"?t.visibility=Math.round(t.visibility*.0006213712121212121):t.visibility=Math.round(t.visibility/1e3),t.main.feels_like=Math.floor(t.main.feels_like),t.weather[0].icon="https://openweathermap.org/img/wn/"+t.weather[0].icon+"@2x.png",t.main.temp=Math.floor(t.main.temp),t.name=`${t.name}, ${t.sys.country}`,this.data=t,this.currentWeatherSubject.next(t),this.haveData=!0}getVisKm(){return this.visibilityKM}setTwoWeeksData(t){this.twoWeeksData=t}setSearch(t){this.listCities=t}setSearchTerm(t){this.searchLocation=t}getSearchTerm(){return this.searchLocation}clearSearch(){this.listCities=[]}search(t){this.weatherdata.getWeatherDataFromApi(this.apikeyservice.getKey(),t.name,t.country,this.unit.getSettings().units).subscribe(e=>{this.setCurrentWeatherData(e)}),this.weatherdata.getTwoWeeksForcast(this.apikeyservice.getKey(),t.lat,t.lon,this.unit.getSettings().units).subscribe(e=>{this.setTwoWeeksData(e)}),this.clearSearch()}onInputSubmit(t){if(t===""){this.clearSearch();return}this.setSearchTerm(t),this.weatherdata.getLocationInfo(this.apikeyservice.getKey(),this.searchLocation).subscribe(e=>{this.setSearch(e)}),console.log(this.searchLocation)}getCurrentWeather(){return this.data}currentWeather$(){return this.currentWeatherSubject.asObservable()}getTwoWeeks(){return this.twoWeeksData}getListOfCities(){return this.listCities}responseStatus(){return this.haveData?!0:this.haveData}static \u0275fac=function(e){return new(e||i)};static \u0275prov=a({token:i,factory:i.\u0275fac,providedIn:"root"})};export{c as a,h as b,d as c};
